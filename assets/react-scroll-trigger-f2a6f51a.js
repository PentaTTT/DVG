import{a as P,r as L}from"./react-1c7c5f57.js";import{P as i}from"./prop-types-17c45f42.js";import{R as j}from"./react-dom-51b28a26.js";import{t as f}from"./lodash.throttle-9f45b31f.js";import{c as x}from"./clean-react-props-2fd3ae58.js";function R(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,e)}return r}function w(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?R(Object(r),!0).forEach(function(e){M(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function M(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function b(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function V(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,O(t,n)}function O(t,n){return O=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e},O(t,n)}var T=function(t){V(n,t);function n(e){var o;return o=t.call(this,e)||this,o.onScrollThrottled=f(o.onScroll.bind(b(o)),e.throttleScroll,{trailing:!1}),o.onResizeThrottled=f(o.onResize.bind(b(o)),e.throttleResize,{trailing:!1}),o.state={inViewport:!1,progress:0,lastScrollPosition:null,lastScrollTime:null},o}var r=n.prototype;return r.componentDidMount=function(){addEventListener("resize",this.onResizeThrottled),addEventListener("scroll",this.onScrollThrottled),this.props.triggerOnLoad&&this.checkStatus()},r.componentDidUpdate=function(o,s){o.throttleScroll!==this.props.throttleScroll&&(removeEventListener("scroll",this.onScrollThrottled),this.onScrollThrottled=f(this.onScroll.bind(this),this.props.throttleScroll,{trailing:!1}),addEventListener("scroll",this.onScrollThrottled)),o.throttleResize!==this.props.throttleResize&&(removeEventListener("resize",this.onResizeThrottled),this.onResizeThrottled=f(this.onResize.bind(this),this.props.throttleResize,{trailing:!1}),addEventListener("resize",this.onResizeThrottled))},r.componentWillUnmount=function(){removeEventListener("resize",this.onResizeThrottled),removeEventListener("scroll",this.onScrollThrottled)},r.onResize=function(){this.checkStatus()},r.onScroll=function(){this.checkStatus()},r.checkStatus=function(){var o=this.props,s=o.containerRef,u=o.onEnter,c=o.onExit,a=o.onProgress,d=this.state,h=d.lastScrollPosition,E=d.lastScrollTime,z=j.findDOMNode(this.element),l=z.getBoundingClientRect(),D=0,_=typeof s=="string"?document.querySelector(s):s,m=s===document.documentElement?Math.max(s.clientHeight,window.innerHeight||0):_.clientHeight,v=l.top<=m&&l.bottom>=D,S=window.scrollY,p=h&&E?Math.abs((h-S)/(E-Date.now())):null;if(v){var y=Math.max(0,Math.min(1,1-l.bottom/(m+l.height)));this.state.inViewport||(this.setState({inViewport:v}),u({progress:y,velocity:p},this)),a({progress:y,velocity:p},this),this.setState({lastScrollPosition:S,lastScrollTime:Date.now()});return}if(this.state.inViewport){var g=l.top<=m?1:0;this.setState({lastScrollPosition:S,lastScrollTime:Date.now(),inViewport:v,progress:g}),a({progress:g,velocity:p},this),c({progress:g,velocity:p},this)}},r.render=function(){var o=this,s=this.props,u=s.children,c=s.component,a=P.isValidElement(c)?"cloneElement":"createElement";return P[a](c,w(w({},x(this.props,["onProgress"])),{},{ref:function(h){o.element=h}}),u)},n}(L.Component);T.propTypes={component:i.oneOfType([i.element,i.node]),containerRef:i.oneOfType([i.object,i.string]),throttleResize:i.number,throttleScroll:i.number,triggerOnLoad:i.bool,onEnter:i.func,onExit:i.func,onProgress:i.func};T.defaultProps={component:"div",containerRef:typeof document<"u"?document.documentElement:"html",throttleResize:100,throttleScroll:100,triggerOnLoad:!0,onEnter:function(){},onExit:function(){},onProgress:function(){}};export{T as S};
